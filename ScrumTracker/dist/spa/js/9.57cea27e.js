(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[9],{"40ac":function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("q-page",{staticClass:"q-ma-lg window-width"},[e("q-btn",{staticClass:"q-ma-xs",attrs:{"text-color":"primary",flat:"",icon:"arrow_back_ios",label:"Back to project"},on:{click:function(s){return t.$router.back()}}}),e("q-card",{staticClass:"q-ma-lg",attrs:{flat:"",bordered:""}},[e("q-card-section",{attrs:{horizontal:""}},[e("q-card-section",{staticClass:"q-ma-md bg-primary"},[e("div",{staticClass:"text-overline text-white",staticStyle:{transform:"rotate(-90deg)","margin-top":"225%"}},[t._v("Sprint")])]),e("q-card-section",{staticClass:"q-ma-sm",staticStyle:{width:"30%"}},[e("div",{staticClass:"text-h5 q-ma-md"},[t._v(t._s(t.sprints.name))]),e("div",{staticClass:"text-overline q-ma-md"},[t._v("Start Date: "+t._s(t.sprints.start_date))]),e("div",{staticClass:"text-overline q-ma-md"},[t._v("End Date: "+t._s(t.sprints.end_date))]),e("div",{staticClass:"text-overline q-ma-md"},[t._v("Sprint velocity: "),e("span",{staticClass:"text-h6"},[t._v(t._s(t.sprints.expected_time))]),t._v(" points (MD)")])]),e("q-separator",{attrs:{vertical:""}}),e("q-card-section",{staticClass:"full-width"},[e("div",{staticClass:"row"},[e("q-space"),e("div",{staticClass:"q-ma-sm"},[!t.isActive(t.sprints.start_date,t.sprints.end_date)||!0!==t.checkRole("Scrum Master")&&"Admin"!==t.user.permissions?e("div",{staticClass:"text-caption"},[!1===t.isActive(t.sprints.start_date,t.sprints.end_date)?e("span",[t._v("This Sprint is not active.")]):e("span",[t._v("You do not have permissions to add user stories to this Sprint.")])]):e("q-btn",{attrs:{size:"md",color:"primary",label:"Add user story to sprint",icon:"create_new_folder"},on:{click:function(s){t.addCard=!0}}})],1)],1)])],1)],1),[e("div",[e("div",{staticClass:"q-pa-md"},[e("div",{staticClass:"row justify-center items-center content-center "},[e("div",{staticClass:"col-12"},[e("q-card-section",{staticClass:"row bg-secondary"},[e("div",{staticClass:"text-white text-h6 q-ma-sm"},[t._v("Sprint backlog")])]),e("div",{staticClass:"row"},t._l(t.allSprintCards,(function(s,a){return e("div",{key:a,staticClass:"q-pa-md col-md-6 col-sm-12"},[e("CardSprint",{attrs:{allCards:t.allCards,card:s,project:t.project,projectUsers:t.namesOfUsers},on:{resetData:function(s){return t.showCards()}}})],1)})),0)],1)])])])],e("q-dialog",{model:{value:t.editCardData,callback:function(s){t.editCardData=s},expression:"editCardData"}},[e("q-card",{staticClass:"q-pa-md",staticStyle:{width:"80vh"}},[e("q-card-section",{staticClass:"row items-center"},[e("div",{staticClass:"text-h6"},[t._v(" Edit Card ")]),e("q-space"),e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"close",flat:"",round:"",dense:""}})],1),e("CardsForm",{attrs:{allCards:t.allCards,newCard:t.editCards,editCard:!0,editCardId:t.editCardId},on:{submitCard:function(s){return t.showCards()}}})],1)],1),e("q-dialog",{attrs:{"full-width":""},model:{value:t.addCard,callback:function(s){t.addCard=s},expression:"addCard"}},[e("q-card",{staticClass:"q-pa-md"},[e("q-card-section",{staticClass:"row items-center"},[e("div",{staticClass:"text-h6"},[t._v("Add user story to sprint")]),e("q-space"),e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"close",flat:"",round:"",dense:""}})],1),e("AddCard",{attrs:{allCards:t.allProjectCards,sprintId:t.sprintId},on:{addCard:function(s){return t.showCards()}}})],1)],1)],2)},r=[],i=e("7053"),n=e.n(i),c=e("2f62"),d=e("c1df"),o=e.n(d),l=e("2b0e"),u=e("b76a"),p=e.n(u),h=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[t._l(t.allCards,(function(s,a){return e("div",{key:a},[e("div",{staticClass:"row justify-around items-start "},[""===s.sprint_id&&"DONE"!==s.card_round&&""!==s.expected_time&&"Won't have this time"!=s.priority?e("q-card",{staticClass:"col-sm-6 col-md-4 q-pa-sm box-shadow cursor-move bg-white q-mt-xs",attrs:{square:"",flat:"",bordered:""}},[e("q-card-section",{staticClass:"row bg-secondary"},[e("span",{staticClass:"text-white text-h6 q-ma-xxs"},[t._v(t._s(s.card_name))]),e("q-space"),e("span",{staticClass:"text-white text-overline q-ma-xxs"},[t._v("("+t._s(s.priority)+")")]),e("q-space"),e("q-btn",{attrs:{round:"",color:"primary",icon:"add"},on:{click:function(e){return t.addCardToSprint(s)}}})],1),e("q-card-section",{staticClass:"q-pt-sm"},[e("div",{staticClass:"row items-center no-wrap"},[e("div",{staticClass:"col"},[e("div",[e("span",{staticClass:"material-icons text-h5 text-secondary"},[t._v("description")]),t._v(" "+t._s(s.description))])])]),e("div",{staticClass:"row items-center no-wrap"},[""!==s.expected_time?e("div",{staticClass:"col"},[e("div",[e("span",{staticClass:"material-icons text-h4 text-secondary"},[t._v("update")]),e("span",{staticClass:"text-weight-bolder text-h6 text-black"},[t._v(" "+t._s(s.expected_time))]),s.expected_time>1?e("span",{staticClass:"text-p text-black"},[t._v(" points")]):t._e(),1==s.expected_time?e("span",{staticClass:"text-p text-black"},[t._v(" point")]):t._e()])]):t._e(),e("div",{staticClass:"col"},[e("div",{staticClass:"text-overline text-secondary"},[t._v("\n                    VALUE:\n                    "),e("span",{staticClass:"text-weight-bolder text-h6 text-black"},[t._v(t._s(s.value))])])])]),""===s.acceptance_test||0!==s.acceptance_test.length?e("div",{staticClass:"row items-center no-wrap"},[e("div",{staticClass:"col"},[e("div",{staticClass:"text-overline text-secondary"},[t._v("ACCEPTANCE TESTS:")]),t._l(s.acceptance_test,(function(s,a){return e("div",{key:a},[e("span",{staticClass:"material-icons text-h6"},[t._v("tag")]),t._v(t._s(s))])}))],2)]):t._e()])],1):t._e()],1)])})),e("div",{staticClass:"q-ma-md text-center"},[""!=t.error?e("p",{staticStyle:{color:"red"}},[t._v(t._s(t.error))]):t._e()])],2)},m=[],b={name:"AddCardSprint",props:{allCards:{type:Array},sprintId:{type:String}},data(){return{error:"",user:{},sprint:{},editCard:{_id:"",project_id:"",sprint_id:"",expected_time:"",past_expected_time:"",comment:"",card_name:"",description:"",acceptance_test:[],priority:"",value:"",subtasks:[],card_round:""}}},mounted(){this.user=this.getCurrentUser(),this.sprints=this.getSprints()},methods:n()(n()(n()(n()({},Object(c["b"])("card",["updateCard"])),Object(c["c"])("user",["getCurrentUser"])),Object(c["c"])("sprint",["getSprints"])),{},{checkRole(t){var s=!1;if(this.user!=={})for(var e in"Admin"===this.user.permissions&&(s=!0),this.project.users)this.user.username===this.project.users[e].user_name&&this.project.users[e].user_role[1]===t&&(s=!0);return s},exceedsExpectedTime(t){let s={};for(const r in this.sprints)this.sprints[r]._id===this.sprintId&&(s=this.sprints[r]);const e=s.expected_time;let a=0;for(const r in this.allCards)this.allCards[r].sprint_id===this.sprintId&&(a+=parseInt(this.allCards[r].expected_time));return a+=parseInt(t),!(a===e||a<e)},addCardToSprint(t){"Won't have this time"===t.priority?this.error="You can't add this card!":this.exceedsExpectedTime(t.expected_time)?this.error="By adding this card you would exceed the expected time for this sprint.":(this.editCard=t,this.editCard.card_round="SPRINT BACKLOG",this.editCard.sprint_id=this.sprintId,this.updateCard(this.editCard),this.$emit("addCard"))}})},_=b,C=e("2877"),k=e("f09f"),v=e("a370"),f=e("2c91"),x=e("9c40"),g=e("eebe"),j=e.n(g),q=Object(C["a"])(_,h,m,!1,null,null,null),y=q.exports;j()(q,"components",{QCard:k["a"],QCardSection:v["a"],QSpace:f["a"],QBtn:x["a"]});var w=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("q-card",{staticClass:"cursor-move bg-white",attrs:{square:"",flat:"",bordered:""}},[e("q-card-section",{staticClass:"row q-pa-s",class:"DONE"===t.card.card_round?"bg-green-4":"bg-secondary"},[e("span",{staticClass:"text-white text-subtitle2",staticStyle:{"font-size":"17px"}},[t._v(t._s(t.card.card_name))]),e("q-space"),e("q-btn",{staticClass:"q-ma-xs",class:"DONE"===t.card.card_round?"bg-green-8":"bg-primary",attrs:{size:"sm",round:"",color:"primary",icon:"open_in_new"},on:{click:function(s){return t.openCard(t.card)}}})],1),e("q-card-section",[e("UserStoryTasks",{attrs:{project:this.project,card:this.card,projectUsers:this.projectUsers},on:{submit:function(s){t.openCurrentCard=!1},refreshCards:function(s){return t.refreshCards()}}})],1)],1),e("q-dialog",{attrs:{medium:""},model:{value:t.openCurrentCard,callback:function(s){t.openCurrentCard=s},expression:"openCurrentCard"}},[e("q-card",{staticStyle:{width:"800px","max-width":"80vw"}},[e("q-card-section",{staticClass:"row bg-primary text-white"},[e("div",{staticClass:"text-h6"},[t._v(t._s(this.currentCard.card_name))]),e("span",{staticClass:"text-overline",staticStyle:{"margin-left":"10px"}},[t._v(" ("+t._s(this.currentCard.priority)+")")]),e("q-space"),e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"close",flat:"",round:"",dense:""}})],1),e("UserStory",{attrs:{card:this.currentCard,project:this.project,projectUsers:this.projectUsers},on:{submit:function(s){t.openCurrentCard=!1},refreshCards:function(s){return t.refreshCards()}}})],1)],1)],1)},T=[],S=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("q-tabs",{staticClass:"text-primary shadow-2",attrs:{"inline-label":""},model:{value:t.tab,callback:function(s){t.tab=s},expression:"tab"}},[e("q-tab",{attrs:{name:"details",icon:"info",label:"Details"}}),"DONE"!==t.card.card_round?e("q-tab",{attrs:{name:"addSubtasks",icon:"add",label:"Add task"}}):t._e(),t.checkRole("Product Owner")?e("q-tab",{attrs:{name:"acceptReject",icon:"grading",label:"Accept/Reject"}}):t._e(),e("q-space")],1),e("q-separator"),e("q-tab-panels",{attrs:{animated:""},model:{value:t.tab,callback:function(s){t.tab=s},expression:"tab"}},[e("q-tab-panel",{attrs:{name:"details"}},[e("UserStoryDetails",{attrs:{card:this.card,project:this.project}})],1),e("q-tab-panel",{attrs:{name:"addSubtasks"}},[e("AddSubtask",{attrs:{card:this.card,project:this.project,projectUsers:this.projectUsers,subtask:this.subtask,edit:!1},on:{submitTask:t.submit}})],1),t.checkRole("Product owner")?e("q-tab-panel",{attrs:{name:"acceptReject"}},[e("AcceptReject",{attrs:{card:this.card,project:this.project}})],1):t._e()],1),e("div")],1)},O=[],U=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("q-card-section",{staticClass:"q-pt-sm q-mt-md q-mb-md"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col text-body1"},[t._v("\n        "+t._s(t.card.description)+"\n      ")]),e("q-space")],1)]),e("q-separator"),e("q-card-section",[e("div",{staticClass:"row items-center no-wrap"},[""!==t.card.past_expected_time?e("div",{staticClass:"col"},[e("div",{staticClass:"text-grey"},[e("span",{staticClass:"material-icons text-h4 text-secondary"},[t._v("history")]),e("span",{staticClass:"text-weight-bolder text-h6 text-black"},[t._v(" "+t._s(t.card.past_expected_time))]),t.card.past_expected_time>1?e("span",{staticClass:"text-p text-black"},[t._v(" points")]):t._e(),1==t.card.past_expected_time?e("span",{staticClass:"text-p text-black"},[t._v(" point")]):t._e()])]):t._e(),""!==t.card.expected_time?e("div",{staticClass:"col"},[e("div",[e("span",{staticClass:"material-icons text-h4 text-secondary"},[t._v("schedule")]),e("span",{staticClass:"text-weight-bolder text-h6 text-black"},[t._v(" "+t._s(t.card.expected_time))]),t.card.expected_time>1?e("span",{staticClass:"text-p text-black"},[t._v(" points")]):t._e(),1==t.card.expected_time?e("span",{staticClass:"text-p text-black"},[t._v(" point")]):t._e()])]):t._e(),e("div",{staticClass:"col"},[e("div",{staticClass:"text-overline text-secondary"},[t._v("\n          VALUE:"),e("span",{staticClass:"text-weight-bolder text-h6 text-black"},[t._v(t._s(t.card.value))])])])])]),e("q-separator"),e("q-card-section",[""===t.card.acceptance_test||0!==t.card.acceptance_test.length?e("div",{staticClass:"row items-center no-wrap"},[e("div",{staticClass:"col"},[e("div",{staticClass:"text-overline text-secondary"},[t._v("ACCEPTANCE TESTS:")]),t._l(t.card.acceptance_test,(function(s,a){return e("div",{key:a},[e("span",{staticClass:"material-icons text-h6"},[t._v("tag")]),t._v(t._s(s))])}))],2)]):t._e()]),e("q-separator"),""!==t.card.comment?e("div",{staticClass:"row items-center no-wrap q-ma-md"},[e("div",{staticClass:"col text-overline"},[e("span",{staticClass:"text-black"},[t._v("PROJECT OWNER'S COMMENT: ")]),e("span",{staticClass:"text-caption"},[t._v(t._s(t.card.comment))])])]):t._e()],1)},A=[],Q={name:"UserStoryDetails",props:{card:{type:Object},project:{type:Object}}},E=Q,D=e("eb85"),B=Object(C["a"])(E,U,A,!1,null,null,null),I=B.exports;j()(B,"components",{QCardSection:v["a"],QSpace:f["a"],QSeparator:D["a"]});var P=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"q-ma-md"},[e("q-form",{staticClass:"q-ma-md",on:{submit:t.onSubmit,reset:t.onReset}},[e("q-input",{staticClass:"q-ma-md",attrs:{filled:"",disable:""!==t.subtask.assigned_user&&!0===t.edit,label:"Name","lazy-rules":"",rules:[function(t){return null!==t&&""!==t||"Please add name"}]},model:{value:t.subtask.subtask_name,callback:function(s){t.$set(t.subtask,"subtask_name",s)},expression:"subtask.subtask_name"}}),e("q-input",{staticClass:"q-ma-md",staticStyle:{width:"230px"},attrs:{filled:"",type:"number",min:"1",label:"Time expected [hours]","lazy-rules":"",rules:[function(t){return null!==t&&""!==t||"Please select expected time"}]},model:{value:t.subtask.subtask_time,callback:function(s){t.$set(t.subtask,"subtask_time",s)},expression:"subtask.subtask_time"}}),e("q-select",{staticClass:"q-ma-md",attrs:{filled:"",disable:""!==t.subtask.assigned_user&&!0===t.edit,options:t.projectUsers,label:"Assignees",color:"secondary","use-chips":"","stack-label":""},model:{value:t.subtask.assignees,callback:function(s){t.$set(t.subtask,"assignees",s)},expression:"subtask.assignees"}}),e("q-space"),e("q-card-actions",{attrs:{horizontal:"",align:"right"}},[e("q-btn",{attrs:{label:"Submit",type:"submit",color:"primary"}})],1),e("div",{staticClass:"q-ma-md text-center"},[""!=t.error?e("p",{staticStyle:{color:"red"}},[t._v(t._s(t.error))]):t._e()])],1)],1)},N=[],$=e("9612"),R={name:"AddSubtask",props:{card:{type:Object},project:{type:Object},projectUsers:{type:Array},subtask:{type:Object},edit:{type:Boolean}},data(){return{error:"",uuid:$["a"].v1(),submitMessage:"",users:{},usersBeforeEdit:[]}},mounted(){this.fetchUsers(),setTimeout((()=>{this.users=this.getUsers()}),200),this.usersBeforeEdit=this.subtask.assignees},methods:n()(n()(n()(n()(n()({},Object(c["b"])("card",["updateCard"])),Object(c["b"])("user",["updateUserTasks"])),Object(c["c"])("user",["getUsers"])),Object(c["b"])("user",["fetchUsers"])),{},{onSubmit(){this.edit?this.editTaskFunction():(this.addTaskFunction(),this.onReset()),this.$q.notify({color:"green",textColor:"white",icon:"cloud_done",message:this.submitMessage,position:"top-right",timeout:1e3}),this.$emit("submitTask")},setTask(){const t={};if(!1===this.edit?t.subtask_id=this.uuid:t.subtask_id=this.subtask.subtask_id,this.subtask.assignees&&0!==this.subtask.assignees.length)if(Array.isArray(this.subtask.assignees))t.assignees=this.subtask.assignees;else{const s=[];s.push(this.subtask.assignees),t.assignees=s}else t.assignees=this.projectUsers;return t.subtask_name=this.subtask.subtask_name,t.subtask_time=this.subtask.subtask_time,t.assigned_user="",t.done=!1,t},getCurrentUser(t){for(const s in this.users)if(this.users[s].username===t)return this.users[s];return null},editTaskCard(t){for(const s in this.card.subtasks)this.card.subtasks[s].subtask_id===t.subtask_id&&(this.card.subtasks[s]=t)},deleteTaskFromUser(t,s){for(const e in t.tasks)t.tasks[e].subtask_id===s.subtask_id&&t.tasks.pop(t.tasks[e]);return t},editTaskFunction(){if(console.log(this.subtask),""===this.subtask.assigned_user){this.submitMessage="Task edited.";const t=this.setTask();this.editTaskCard(t),this.updateCard(this.card);for(const s in this.usersBeforeEdit){let e=this.getCurrentUser(this.usersBeforeEdit[s]);e=this.deleteTaskFromUser(e,t),this.updateUserTasks(e)}setTimeout((()=>{const s={accepted:!1};s.card_id=this.card._id,s.subtask_id=t.subtask_id;for(const e in t.assignees){const a=this.getCurrentUser(t.assignees[e]);a.tasks.push(s),this.updateUserTasks(a)}}),3e3),this.usersBeforeEdit=[]}else{const t={};t.subtask_id=this.subtask.subtask_id,t.subtask_name=this.subtask.subtask_name,t.subtask_time=this.subtask.subtask_time,t.assignees=this.subtask.assignees,t.assigned_user=this.subtask.assigned_user,t.done=!1,this.editTaskCard(t),this.updateCard(this.card)}},addTaskFunction(){const t=this.setTask();this.card.subtasks.push(t),this.updateCard(this.card);const s={accepted:!1};if(s.card_id=this.card._id,s.subtask_id=t.subtask_id,!Array.isArray(t.assignees)){const s=[];s.push(t.assignees),t.assignees=s}for(const e in t.assignees){const a=this.getCurrentUser(t.assignees[e]);a.tasks.push(s),this.updateUserTasks(a)}this.submitMessage="Task added."},onReset(){this.subtask.subtask_name="",this.subtask.subtask_time="",this.subtask.assignees=[],this.subtask.subtask_id="",this.error=""}})},M=R,Y=e("0378"),z=e("27f9"),F=e("ddd8"),L=e("4b7e"),G=Object(C["a"])(M,P,N,!1,null,null,null),J=G.exports;j()(G,"components",{QForm:Y["a"],QInput:z["a"],QSelect:F["a"],QSpace:f["a"],QCardActions:L["a"],QBtn:x["a"]});var K=e("be75"),V={name:"Card",components:{UserStoryDetails:I,AddSubtask:J,AcceptReject:K["a"]},props:{card:{type:Object},project:{type:Object},projectUsers:{type:Array}},mounted(){this.user=this.getCurrentUser()},methods:n()(n()({},Object(c["c"])("user",["getCurrentUser"])),{},{submit(){this.tab="details",this.$emit("refreshCards")},checkRole(t){var s=!1;if(this.user!=={})for(var e in this.project.users)this.user.username===this.project.users[e].user_name&&this.project.users[e].user_role[1]===t&&(s=!0);return s}}),data(){return{tab:"details",projects:{},currentProject:{},subtask:{subtask_name:"",subtask_time:"",assignees:[]},user:{}}}},W=V,H=e("429b"),X=e("7460"),Z=e("adad"),tt=e("823b"),st=Object(C["a"])(W,S,O,!1,null,null,null),et=st.exports;j()(st,"components",{QTabs:H["a"],QTab:X["a"],QSpace:f["a"],QSeparator:D["a"],QTabPanels:Z["a"],QTabPanel:tt["a"]});var at=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[""!==t.card.subtasks||0!==t.card.subtasks.length?e("div",[e("q-table",{staticClass:"q-pa-lg",staticStyle:{"box-shadow":"none"},attrs:{data:t.card.subtasks,columns:t.columns,"virtual-scroll":"","rows-per-page-options":[0],"hide-bottom":""},scopedSlots:t._u([{key:"loading",fn:function(){return[e("q-inner-loading",{attrs:{showing:"",color:"primary"}})]},proxy:!0},{key:"body-cell-status",fn:function(s){return[e("q-td",{attrs:{props:s}},[e("div",[!0===s.row.done?e("span",{staticClass:"text-teal"},[t._v("DONE")]):t._e(),!0!==s.row.done?e("span",{staticClass:"text-blue-4"},[t._v("ACTIVE")]):t._e()])])]}},{key:"body-cell-name",fn:function(s){return[e("q-td",{staticClass:"text-caption",staticStyle:{"font-size":"13px"},attrs:{props:s}},[t._v("\n          "+t._s(s.row.subtask_name)+"\n        ")])]}},{key:"body-cell-assignee",fn:function(s){return[e("q-td",{attrs:{props:s}},[""!==s.row.assigned_user?e("span",[e("b",[t._v(t._s(t.getUserIdentity(s.row.assigned_user)))])]):t._e(),""===s.row.assigned_user?e("span",{staticClass:"text-grey-9"},[e("b",[t._v("Not assigned")])]):t._e()])]}},{key:"body-cell-time",fn:function(s){return[e("q-td",{attrs:{props:s}},[t._v("\n          "+t._s(s.row.subtask_time)+"h\n        ")])]}},{key:"body-cell-delete",fn:function(s){return[e("q-td",{attrs:{props:s}},[""===s.row.assigned_user?e("q-btn",{staticClass:"q-ma-xs",staticStyle:{"font-size":"10px"},attrs:{round:"",color:"red-5",icon:"delete"},on:{click:function(e){t.deleteTaskBool=!0,t.deleteTaskObj=s.row}}}):t._e(),e("q-btn",{staticClass:"q-ma-xs",staticStyle:{"font-size":"10px"},attrs:{round:"",color:"blue-5",icon:"edit"},on:{click:function(e){t.editTaskObj=s.row,t.editTaskBool=!0}}})],1)]}}],null,!1,338978551)})],1):t._e(),""===t.card.subtasks||0===t.card.subtasks.length?e("div",{staticClass:"text-overline text-center",staticStyle:{"font-size":"13px"}},[t._v("\n    There are no tasks in this user story.\n  ")]):t._e(),e("div",[e("q-dialog",{model:{value:t.editTaskBool,callback:function(s){t.editTaskBool=s},expression:"editTaskBool"}},[e("q-card",{staticClass:"q-pa-md",staticStyle:{width:"80vh"}},[e("q-card-section",{staticClass:"row items-center"},[e("div",{staticClass:"text-h6"},[t._v(" Edit Task ")]),e("q-space"),e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"close",flat:"",round:"",dense:""}})],1),e("AddSubtask",{attrs:{card:this.card,project:this.project,subtask:this.editTaskObj,edit:!0,projectUsers:this.projectUsers},on:{submitTask:function(s){t.editTaskBool=!1,t.$emit("submit")}}})],1)],1),e("q-dialog",{attrs:{"transition-show":"scale","transition-hide":"scale"},model:{value:t.deleteTaskBool,callback:function(s){t.deleteTaskBool=s},expression:"deleteTaskBool"}},[e("q-card",{staticClass:"text-subtitle1 text-center",staticStyle:{width:"300px"}},[e("q-card-section",[t._v("\n        Are you sure you want to delete this Task?\n        "),e("q-card-actions",{attrs:{align:"center"}},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel",color:"teal"}}),e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"DELETE",color:"red-6"},on:{click:function(s){return t.deleteFunction()}}})],1)],1)],1)],1)],1)])},rt=[],it={name:"UserStoryTasks",components:{AddSubtask:J},props:{card:{type:Object},project:{type:Object},projectUsers:{type:Array}},data(){return{users:{},editTaskBool:!1,deleteTaskBool:!1,deleteTaskObj:{},editTaskObj:{},allCards:{},columns:[{name:"status",align:"center",label:"Status"},{name:"name",required:!0,label:"Name",align:"center",field:"name"},{name:"assignee",required:!0,align:"center",label:"Assignee",field:"assignee"},{name:"time",required:!0,align:"center",label:"Time expected",field:"time"},{name:"delete",align:"center",label:""}]}},mounted(){this.fetchUsers(),this.users=this.getUsers(),this.allCards=this.getCards(),this.currentUser=this.getCurrentUser()},methods:n()(n()(n()(n()(n()(n()({},Object(c["c"])("user",["getUsers"])),Object(c["b"])("user",["fetchUsers","updateUserTasks","updateCurrentUser"])),Object(c["c"])("card",["getCards"])),Object(c["b"])("card",["updateCard"])),Object(c["c"])("user",["getUsers","getCurrentUser"])),{},{getUserIdentity(t){for(const s in this.users)if(this.users[s]._id===t)return this.users[s].username},getUserIdentityObj(t){for(const s in this.users)if(this.users[s].username===t)return this.users[s]},deleteFunction(){const t=this.getCurrentCard(),s=t.subtasks.filter((t=>t.subtask_id!==this.deleteTaskObj.subtask_id));t.subtasks=s,this.updateCard(t);for(const e in this.deleteTaskObj.assignees){const t=this.getUserIdentityObj(this.deleteTaskObj.assignees[e]),s=t.tasks.filter((t=>t.subtask_id!==this.deleteTaskObj.subtask_id));t.tasks=s,this.updateUserTasks(t),this.updateCurrentUser(t)}this.$emit("refreshCards")},editTaskFunction(){this.editTaskBool=!1,this.$emit("refreshCards")},getCurrentCard(){for(const t in this.allCards)for(const s in this.allCards[t].subtasks)if(this.allCards[t].subtasks[s].subtask_id===this.deleteTaskObj.subtask_id)return this.allCards[t]},getCurrentTask(t,s){for(const e in s)if(s[e].subtask_id===t)return s[e]}})},nt=it,ct=e("eaac"),dt=e("74f7"),ot=e("db86"),lt=e("24e8"),ut=e("7f67"),pt=Object(C["a"])(nt,at,rt,!1,null,null,null),ht=pt.exports;j()(pt,"components",{QTable:ct["a"],QInnerLoading:dt["a"],QTd:ot["a"],QBtn:x["a"],QDialog:lt["a"],QCard:k["a"],QCardSection:v["a"],QSpace:f["a"],QCardActions:L["a"]}),j()(pt,"directives",{ClosePopup:ut["a"]});var mt={name:"CardSprint",components:{UserStory:et,UserStoryTasks:ht},props:{card:{type:Object},project:{type:Object},projectUsers:{type:Array}},data(){return{openCurrentCard:!1,currentCard:{}}},methods:{openCard(t){this.openCurrentCard=!0,this.currentCard=t},refreshCards(){this.$emit("resetData")}}},bt=mt,_t=Object(C["a"])(bt,w,T,!1,null,null,null),Ct=_t.exports;j()(_t,"components",{QCard:k["a"],QCardSection:v["a"],QSpace:f["a"],QBtn:x["a"],QDialog:lt["a"]}),j()(_t,"directives",{ClosePopup:ut["a"]}),l["a"].component("draggable",p.a);var kt={name:"Sprint",components:{AddCard:y,CardSprint:Ct},data(){return{addCard:!1,editCard:!0,editCardData:!1,confirmDelete:!1,deleteCardId:"",editCardId:"",task_index:{to_do_index:null,in_progress_index:null,test_index:null,done_index:null},sections:[{id:1,name:"PRODUCT BACKLOG",theme:"to-do-title",border:"border-todo"},{id:2,name:"SPRINT BACKLOG",theme:"in-progress-title",border:"border-in-progress"},{id:1,name:"DONE",theme:"done-title",border:"border-done"}],sprints:[],cards:[],user:{},allProjectCards:[],allSprintCards:[],editCards:{sprint_id:"",project_id:"",expected_time:"",past_expected_time:"",comment:"",card_name:"",description:"",acceptance_test:[],priority:"",value:"",subtasks:[],card_round:""},sprintId:"",drag:!1,namesOfUsers:[]}},computed:{dragOptions(){return{animation:200,group:"description",disabled:!1,ghostClass:"ghost"}}},mounted(){this.fetchCards(),this.user=this.getCurrentUser(),this.sprintId=this.$route.params.id,this.sprints=this.sprint(),this.showCards(),this.allProjectCards=this.projectCards(),this.project=this.currentProject(),this.namesOfUsers=this.namesOfProjectUsers()},props:{allCards:{type:Array},sprint_id:{type:String}},methods:n()(n()(n()(n()(n()(n()({},Object(c["c"])("user",["getCurrentUser"])),Object(c["c"])("card",["getCards"])),Object(c["c"])("sprint",["getSprints"])),Object(c["b"])("card",["fetchCards","updateCard"])),Object(c["c"])("project",["getProjects"])),{},{projectCards(){var t=this.getCards(),s=[];for(var e in t)t[e].project_id===this.projectId&&s.push(t[e]);return s},sprint(){var t=this.getSprints();for(var s in t)if(t[s]._id===this.sprintId)return this.projectId=t[s].project_id,t[s];return"No sprint found."},showCards(){this.addCard=!1,setTimeout((()=>{var t=this.getCards();this.allSprintCards=this.cardsToArray(t)}),200)},cardsToArray(t){var s=[];for(var e in t)t[e].sprint_id===this.sprintId&&s.push(t[e]);return s},isActive(t,s){var e=o()(t,"DD/MM/YYYY"),a=o()(s,"DD/MM/YYYY"),r=new Date,i=o()(r,"DD/MM/YYYY");return i>e&&i<a},checkRole(t){var s=!1;if(this.user!=={})for(var e in this.project.users)this.user.username===this.project.users[e].user_name&&this.project.users[e].user_role[1]===t&&(s=!0);return s},currentProject(){var t=this.getProjects();for(var s in t)if(t[s]._id===this.sprints.project_id)return t[s];return"No project found."},namesOfProjectUsers(){const t=[];for(var s in this.project.users)"scrum master"!==this.project.users[s].user_role[1].toLowerCase()&&"product owner"!==this.project.users[s].user_role[1].toLowerCase()&&t.push(this.project.users[s].user_name);return t}})},vt=kt,ft=e("9989"),xt=Object(C["a"])(vt,a,r,!1,null,null,null);s["default"]=xt.exports;j()(xt,"components",{QPage:ft["a"],QBtn:x["a"],QCard:k["a"],QCardSection:v["a"],QSeparator:D["a"],QSpace:f["a"],QDialog:lt["a"]}),j()(xt,"directives",{ClosePopup:ut["a"]})}}]);